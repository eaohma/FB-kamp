<!DOCTYPE html>
<html lang="no">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Resultattavle</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <link rel="manifest" href="manifest.json">
  <link rel="apple-touch-icon" href="icon-180.png">

  <style>
    @media print{
      body{background:#fff;color:#000}
      .card,button,#lock{display:none!important}
      h1{color:#000}
      ul,li{display:block}
    }
    :root{
      --bg:#0f1115;--card:#1a1d23;--primary:#0a84ff;--danger:#ff453a;
      --secondary:#2a2f3a;--text:#f5f5f7;--muted:#9ba1ad;
    }
    body{margin:0;padding:env(safe-area-inset-top) 16px env(safe-area-inset-bottom);font-family:-apple-system,BlinkMacSystemFont,"SF Pro Text",sans-serif;background:var(--bg);color:var(--text)}
    h1{text-align:center;margin:16px 0}
    h3{margin:0 0 10px;color:var(--muted)}
    .card{background:var(--card);border-radius:22px;padding:16px;margin-bottom:16px}
    input,textarea{width:100%;padding:10px;border-radius:14px;border:none;background:var(--secondary);color:var(--text);margin-bottom:10px}
    textarea{resize:none;height:70px}
    button{padding:14px;border:none;border-radius:18px;font-size:16px;font-weight:600;background:var(--primary);color:#fff}
    button.secondary{background:var(--secondary)}
    .playersGrid{display:grid;grid-template-columns:repeat(auto-fill,minmax(160px,1fr));gap:10px}
    .player{display:flex;gap:6px;align-items:center}
    .player button{flex:1;white-space:nowrap;font-size:14px;padding:10px}
    .minus{background:var(--danger);max-width:60px}
    .scoreRow{display:flex;justify-content:space-between;align-items:center;font-size:22px;margin:14px 0}
    ul{list-style:none;padding:0;margin:0}
    li{background:var(--secondary);border-radius:16px;padding:12px;margin-bottom:12px;font-size:14px}
    li button{margin-top:10px;width:100%;background:var(--danger)}
    small{color:var(--muted)}
    .badge{display:inline-block;padding:4px 10px;border-radius:999px;font-size:12px;font-weight:700;margin-left:8px}
    .win{background:#2ecc71;color:#102a1c}
    .draw{background:#f1c40f;color:#3a2f00}
    .loss{background:#e74c3c;color:#2a0e0e}
  </style>
</head>
<body>

<!-- PASSWORD LOCK -->
<div id="lock" style="position:fixed;inset:0;background:#0f1115;z-index:9999;display:flex;flex-direction:column;align-items:center;justify-content:center;padding:24px">
  <h1 style="margin-bottom:20px">ðŸ”’ LÃ¥s opp</h1>
  <input id="pw" type="password" placeholder="Passord" style="max-width:260px" />
  <button id="loginBtn" style="max-width:260px;width:100%">LÃ¥s opp</button>
  <p id="pwError" style="color:#ff453a;display:none;margin-top:12px">Feil passord</p>
</div>

<h1>âš½ Resultattavle</h1>

<div class="card">
  <input id="teamA" placeholder="Lag A navn" />
  <div style="display:flex;gap:10px;margin-bottom:10px">
    <button id="homeBtn" class="secondary">Hjemmekamp</button>
    <button id="awayBtn" class="secondary">Bortekamp</button>
  </div>
  <textarea id="playersA" placeholder="Spillere Lag A (Ã©n per linje)"></textarea>
  <input id="teamB" placeholder="Lag B navn" />
  <button id="setup">KlargjÃ¸r kamp</button>
</div>

<div class="card">
  <div class="scoreRow"><strong id="nameA">Lag A</strong> <span id="scoreA">0</span></div>
  <div id="players" class="playersGrid"></div>
  <div class="scoreRow"><strong id="nameB">Lag B</strong>
    <div>
      <button class="minus" id="bMinus">âˆ’</button>
      <span id="scoreB">0</span>
      <button id="bPlus">+</button>
    </div>
  </div>
</div>

<div class="card" style="display:flex;gap:10px">
  <button id="save">Lagre kamp</button>
  <button id="export" class="secondary">Eksporter PDF</button>
</div>

<div class="card">
  <h3>Lagrede kamper</h3>
  <ul id="games"></ul>
</div>

<script>
// PASSWORD
const PASSWORD = 'Bogafjell';
const lock = document.getElementById('lock');
const pwError = document.getElementById('pwError');

document.getElementById('loginBtn').addEventListener('click',()=>{
  if(document.getElementById('pw').value === PASSWORD){
    lock.style.display='none';
    pwError.style.display='none';
  } else {
    pwError.style.display='block';
  }
});

// STATE
let matchType = 'Hjemmekamp';
let players={}, scoreB=0;
const $=id=>document.getElementById(id);

// MATCH TYPE TOGGLE
$('homeBtn').onclick=()=>{ matchType='Hjemmekamp'; $('homeBtn').style.background='var(--primary)'; $('awayBtn').style.background='var(--secondary)'; };
$('awayBtn').onclick=()=>{ matchType='Bortekamp'; $('awayBtn').style.background='var(--primary)'; $('homeBtn').style.background='var(--secondary)'; };

// SETUP
$('setup').onclick=()=>{
  players={}; $('players').innerHTML='';
  $('playersA').value.split('\n').map(p=>p.trim()).filter(Boolean).forEach(p=>{
    players[p]=0;
    const row=document.createElement('div'); row.className='player';
    const add=document.createElement('button'); add.textContent=`${p} (0)`; add.dataset.p=p;
    const sub=document.createElement('button'); sub.textContent='âˆ’'; sub.className='minus'; sub.dataset.p=p;
    row.append(add,sub); $('players').appendChild(row);
  });
  $('nameA').textContent=$('teamA').value||'Lag A';
  $('nameB').textContent=$('teamB').value||'Lag B';
  updateScoreA();
};

// PLAYER GOALS
$('players').addEventListener('click',e=>{
  const btn=e.target;
  const p=btn.dataset.p;
  if(!p) return;
  if(btn.classList.contains('minus')) players[p]=Math.max(0,players[p]-1);
  else players[p]++;
  btn.parentElement.querySelector('button:not(.minus)').textContent=`${p} (${players[p]})`;
  updateScoreA();
});

function updateScoreA(){ $('scoreA').textContent=Object.values(players).reduce((a,b)=>a+b,0); }

// TEAM B
$('bPlus').onclick=()=>{ scoreB++; $('scoreB').textContent=scoreB; };
$('bMinus').onclick=()=>{ scoreB=Math.max(0,scoreB-1); $('scoreB').textContent=scoreB; };

// PDF EXPORT
$('export').onclick=()=>{
  window.print();
};

// SAVE
$('save').onclick=()=>{
  const d=new Date();
  const game={
    matchType,
    teamA:$('nameA').textContent,
    teamB:$('nameB').textContent,
    scoreA:$('scoreA').textContent,
    scoreB,
    players,
    date:`${String(d.getDate()).padStart(2,'0')}.${String(d.getMonth()+1).padStart(2,'0')}.${d.getFullYear()}`
  };
  const g=JSON.parse(localStorage.getItem('simpleGames')||'[]'); g.push(game);
  localStorage.setItem('simpleGames',JSON.stringify(g)); render();
};

// RENDER
function render(){ $('games').innerHTML=''; (JSON.parse(localStorage.getItem('simpleGames'))||[]).forEach((g,i)=>{
  const li=document.createElement('li');
  const a=Number(g.scoreA), b=Number(g.scoreB);
  let badge='', cls='';
  if(a>b){ badge='Seier'; cls='win'; }
  else if(a===b){ badge='Uavgjort'; cls='draw'; }
  else { badge='Tap'; cls='loss'; }
  li.innerHTML=`<strong>${g.teamA} (${g.matchType}) ${g.scoreA} â€“ ${g.scoreB} ${g.teamB}</strong> <span class="badge ${cls}">${badge}</span><br>${g.date}`;
  Object.entries(g.players)
    .sort((a,b)=>b[1]-a[1])
    .forEach(([p,v])=>li.innerHTML+=`<br><small>${p}: ${v} mÃ¥l</small>`);
  const delBtn=document.createElement('button'); delBtn.textContent='Slett'; delBtn.onclick=()=>{if(confirm('Slette kamp?')){const arr=JSON.parse(localStorage.getItem('simpleGames'));arr.splice(i,1);localStorage.setItem('simpleGames',JSON.stringify(arr));render();}};
  li.appendChild(delBtn); $('games').appendChild(li);
});}
render();
</script>
</body>
</html>

